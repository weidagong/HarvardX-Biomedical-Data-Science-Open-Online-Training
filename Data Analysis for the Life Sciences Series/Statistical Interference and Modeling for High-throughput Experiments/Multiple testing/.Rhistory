setwd("~/OneDrive - University of North Carolina at Chapel Hill/UNC/HarvardX Biomedical Data Science Open Online Training/Data Analysis for the Life Sciences Series/Statistical Interference and Modeling for High-throughput Experiments/Multiple testing")
knitr::opts_chunk$set(echo = TRUE)
population <- read.csv("femaleControlsPopulation.csv", stringsAsFactors = F)
set.seed(1)
population <- read.csv("femaleControlsPopulation.csv", stringsAsFactors = F)
population
population <- unlist(read.csv("femaleControlsPopulation.csv", stringsAsFactors = F))
pvals <- replicate(m, {
control <- sample(population, N)
treatment <- sample(population, N)
t.test(control, treatment)$p.value
})
alpha <- 0.05
N <- 12
m <- 10000
pvals <- replicate(m, {
control <- sample(population, N)
treatment <- sample(population, N)
t.test(control, treatment)$p.value
})
sum(pvals < 0.05)
alpha <- 0.05
N <- 12
m <- 10000
p0 <- 0.9 #10% positive
m0 <- m * p0
m1 <- m - m0
nullHypothesis <- c(rep(TRUE, m0), rep(FALSE, m1))
delta <- 3
set.seed(1)
calls <- sapply(1:m, function(i){
control <- sample(population, N)
treatment <- sample(population, N)
if (!nullHypothesis[i]){
treatment <- treatment + delta
}
ifelse(t.test(treatment, control)$p.value < alpha,
"Called significant",
"Not called significant")
})
nullHypothesis
calls
table(nullHypothesis, calss)
table(nullHypothesis, calls)
null_hypothesis <- factor(nullHypothesis, levels = c("TRUE", "FALSE")) #Reorder
table(null_hypothesis, calls)
?print
B <- 10 #repeat 10 times
FPandFN <- replicate(B, {
calls <- sapply(1:m, function(i){
control <- sample(population, N)
treatment <- sample(population, N)
if (!nullHypothesis[i]){
treatment <- treatment + delta
}
t.test(treatment, control)$p.value < alpha
})
cat("False positives = ", sum(nullHypothesis & calss),
"False negatives = ", sum(!nullHypothesis & !calls))
c(sum(nullHypothesis & calls), sum(!nullHypothesis & !calss))
})
B <- 10 #repeat 10 times
FPandFN <- replicate(B, {
calls <- sapply(1:m, function(i){
control <- sample(population, N)
treatment <- sample(population, N)
if (!nullHypothesis[i]){
treatment <- treatment + delta
}
t.test(treatment, control)$p.value < alpha
})
cat("False positives = ", sum(nullHypothesis & calls),
"False negatives = ", sum(!nullHypothesis & !calls))
c(sum(nullHypothesis & calls), sum(!nullHypothesis & !calls))
})
FPandFN
pvals
B <- 10 #repeat 10 times
FPandFN <- replicate(B, {
calls <- sapply(1:m, function(i){
control <- sample(population, N)
treatment <- sample(population, N)
if (!nullHypothesis[i]){
treatment <- treatment + delta
}
t.test(treatment, control)$p.value < alpha
})
cat("False positives = ", sum(nullHypothesis & calls),
"False negatives = ", sum(!nullHypothesis & !calls), "\n")
c(sum(nullHypothesis & calls), sum(!nullHypothesis & !calls))
})
```{r}
set.seed(1)
pvals <- saply(1:m, function(i){
control <- sample(population, N)
treatment <- sample(population, N)
if(!nullHypothesis[i]) treatment <- treatment + delta
t.test(control, treatment)$p.value
})
set.seed(1)
pvals <- sapply(1:m, function(i){
control <- sample(population, N)
treatment <- sample(population, N)
if(!nullHypothesis[i]) treatment <- treatment + delta
t.test(control, treatment)$p.value
})
sum(pvals <- alpha/m)
sum(pvals < alpha/m)
pvals
m
pvals
pvals <- sapply(1:m, function(i){
control <- sample(population, N)
treatment <- sample(population, N)
if(!nullHypothesis[i]) treatment <- treatment + delta
t.test(control, treatment)$p.value
})
sum(pvals < alpha/m)
